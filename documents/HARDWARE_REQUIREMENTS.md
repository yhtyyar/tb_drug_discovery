# ТРЕБОВАНИЯ К ЖЕЛЕЗУ И ИНФРАСТРУКТУРЕ
## TB Drug Discovery ML Pipeline: Minimal vs Optimal Setup

**Версия:** 2.0  
**Дата:** Декабрь 2025  
**Статус:** Production Ready

---

## ЧАСТЬ 1: МИНИМАЛЬНЫЕ ТРЕБОВАНИЯ (СТАРТ СЕЙЧАС)

### Этап 1: QSAR обучение (Месяцы 1-2)

#### Минимальное оборудование:

| Компонент | Минимум | Реальное требование |
|-----------|---------|-------------------|
| **CPU** | Intel i5 / AMD Ryzen 5 | 6+ ядер (2.5+ GHz) |
| **RAM** | 8 GB | 8-16 GB (много DataFrames) |
| **GPU** | Не обязательна | Хорошо бы T4 (Colab бесплатно) |
| **Диск** | 128 GB SSD | 256 GB SSD (ChEMBL данные + модели) |
| **Сеть** | 10 Mbps | 50+ Mbps (загрузка датасетов) |

**Оценка стоимости:** €200-500 б/у ноутбук или Colab бесплатно

**Где работать:**
- Личный ноутбук (Windows/Mac/Linux)
- **ИЛИ Google Colab (бесплатно, T4 GPU)**
- Школьный/университетский компьютер

**Performance:**
- QSAR обучение: **5-10 минут** на CPU
- Предсказание 1000 молекул: **1-2 минуты**
- Дозинг 100 молекул: **30-60 минут** (AutoDock Vina, CPU)

---

### Этап 2: GNN обучение (Месяцы 3-6)

#### Требования повышаются:

| Компонент | Минимум для GNN | Рекомендуемо |
|-----------|-----------------|------------|
| **GPU VRAM** | 4 GB (T4 на Colab) | 8 GB+ (RTX 3070, RTX 4070) |
| **GPU тип** | NVIDIA CUDA capable | NVIDIA A100 (облако) или RTX серия |
| **RAM** | 16 GB | 32 GB |
| **Диск** | 256 GB SSD | 512 GB SSD (модели + логи) |
| **Процессор** | Любой на 6+ ядер | Intel i7/Ryzen 7 (для CPU fallback) |

**Оценка стоимости:**
- **Бесплатный вариант:** Google Colab Pro ($10/мес) → T4 GPU
- **Дешевый вариант:** Colab → Tesla T4 (11 GB VRAM)
- **Профессиональный:** AWS EC2 g4dn.xlarge ($0.526/час)

**Performance:**
- GNN обучение на 500 молекул: **30-60 минут** (T4 GPU)
- GNN обучение на 5000 молекул: **3-5 часов** (T4)
- Inference (предсказание): **<1 мин для 1000 молекул** (GPU)

**Bottleneck:** GPU память. T4 (11 GB) достаточна для всех сценариев PhD

---

### Этап 3: Молекулярный дозинг (Параллельно)

#### Дозинг требования:

| Компонент | Минимум | Для ускорения |
|-----------|---------|--------------|
| **CPU cores** | 4 ядра | 8+ ядер (параллельный дозинг) |
| **RAM** | 8 GB | 16 GB |
| **Диск** | 256 GB | 512 GB (кэш структур белков) |
| **Software** | AutoDock Vina (бесплатно) | GNINA (GPU версия) |

**Performance AutoDock Vina:**
- 1 лиганд на 1 CPU: **2-3 минуты**
- 100 лигандов параллельно (8 cores): **25-30 минут** (с параллелизмом)
- 1000 лигандов: **4-5 часов** (массовая обработка)

**GPU ускорение (GNINA):**
- 1000 лигандов на RTX 3070: **15-20 минут** (50x ускорение)
- **Не критично для PhD** (CPU достаточен)

---

## ЧАСТЬ 2: ОПТИМАЛЬНЫЕ ТРЕБОВАНИЯ (FUTURE-PROOF)

### Для быстрого development cycle (Месяцы 6-36):

#### Идеальная setup:

```
┌──────────────────────────────────────────────────────┐
│ ЛОКАЛЬНАЯ МАШИНА (для разработки)                    │
├──────────────────────────────────────────────────────┤
│ CPU: Intel Xeon / AMD Ryzen 7 9700X (16 ядер)        │
│ RAM: 64 GB DDR5                                      │
│ GPU: RTX 4090 (24 GB VRAM) ИЛИ RTX 6000 Ada (48 GB) │
│ Диск: 2x 1TB NVMe SSD (RAID 0)                       │
│ Сеть: 1 Gbps Ethernet                                │
│ OS: Ubuntu 22.04 LTS / Windows 11 с WSL2             │
│ Стоимость: €5000-8000                                │
└──────────────────────────────────────────────────────┘
         ↓
┌──────────────────────────────────────────────────────┐
│ ОБЛАЧНАЯ МАШИНА (для heavy lifting)                 │
├──────────────────────────────────────────────────────┤
│ Провайдер: AWS / Google Cloud / Azure                │
│ Compute: 2x A100 GPU (80 GB каждая)                  │
│ CPU: 64 vCPU (Intel Xeon или AMD EPYC)              │
│ RAM: 512 GB                                          │
│ Диск: 5 TB NVMe (высокоскоростное хранилище)        │
│ Стоимость: €50-150/день (pay-as-you-go)             │
│ Использование: 2-3 раза в неделю (переобучение)     │
└──────────────────────────────────────────────────────┘
```

### Hardware progression по этапам PhD:

#### Месяцы 1-3 (QSAR + базовые эксперименты):
- **Локально:** Любой ноутбук (CPU only)
- **Облако:** Google Colab бесплатно (T4)
- **Стоимость:** $0-10/мес

#### Месяцы 4-8 (GNN + первые синтезы):
- **Локально:** RTX 3070 (8 GB VRAM) - **$400-600 б/у**
- **Облако:** AWS g4dn.xlarge ($0.526/час) - **$200-300/мес при интенсивном использовании**
- **Альтернатива:** Colab Pro ($10/мес) ← **РЕКОМЕНДУЕТСЯ**

#### Месяцы 9-24 (Diffusion + AlphaFold + полный pipeline):
- **Локально:** RTX 4090 (24 GB) - **€2000-3000**
- **Облако:** A100 на AWS (обучение моделей)
- **Гибридный подход:** Локально для development, облако для training

#### Месяцы 25-36 (Завершение + массовые вычисления):
- **Облако:** 2x A100 для финальных запусков
- **Локально:** RTX 4090 для quick experiments
- **CI/CD:** GitHub Actions для automated testing (бесплатно)

---

## ЧАСТЬ 3: ДЕТАЛЬНЫЙ БЮДЖЕТ ДЛЯ PhD (36 месяцев)

### Сценарий 1: МИНИМАЛЬНЫЙ БЮДЖЕТ (Рекомендуется для начинающих)

```
├─ МЕСЯЦЫ 1-6 (QSAR + GNN базовый)
│  ├─ Личный ноутбук: €0 (используешь свой) 
│  ├─ Google Colab Pro: €8 x 6 = €48
│  ├─ AutoDock Vina: €0 (бесплатно)
│  └─ Subtotal: €48
│
├─ МЕСЯЦЫ 7-18 (GNN продвинутый + Diffusion)
│  ├─ Colab Pro: €8 x 12 = €96
│  ├─ AWS (периодический, 10 часов/мес): €200 x 12 = €2400
│  └─ Subtotal: €2496
│
└─ МЕСЯЦЫ 19-36 (Финальный pipeline)
   ├─ AWS (20 часов/мес): €400 x 18 = €7200
   ├─ Дополнительные инструменты: €500
   └─ Subtotal: €7700

ИТОГО БЮДЖЕТ: €10,244 (~€285/мес)
```

### Сценарий 2: ОПТИМАЛЬНЫЙ БЮДЖЕТ (Для быстрого development)

```
├─ ОДИН РАЗ (инвестиция в оборудование)
│  ├─ RTX 4070 (12 GB): €800
│  ├─ Процессор: €400 (Ryzen 7)
│  ├─ RAM 64 GB: €300
│  ├─ SSD 2TB: €200
│  └─ Subtotal: €1700
│
├─ МЕСЯЧНЫЕ РАСХОДЫ (36 месяцев)
│  ├─ AWS A100 (дорогие вычисления): €5000 x 12 = €60,000
│  │  (используется 3-4 раза в год для 10 дней)
│  ├─ GitHub Pro: €6 x 36 = €216
│  ├─ PyMOL Academic License: €0 (бесплатно для academia)
│  └─ Subtotal: €60,216
│
└─ ИТОГО: €61,916 (~€1720/мес)
```

---

## ЧАСТЬ 4: КОНКРЕТНЫЕ КОНФИГУРАЦИИ

### Конфигурация A: БЮДЖЕТНЫЙ СТАРТ (€300 одноразово)

```yaml
ИСПОЛЬЗОВАНИЕ: Google Colab Pro ($10/мес)
КОГДА: Месяцы 1-6 (QSAR + базовый GNN)

Specs:
  GPU: T4 (11 GB VRAM) - как в облаке
  CPU: До 8 vCPU (динамически)
  RAM: 12-27 GB (зависит от нагрузки)
  Диск: 100-500 GB (сеансовый)

Performance:
  QSAR обучение: 5-10 мин
  GNN на 500 молекул: 30-45 мин
  Inference: <1 мин на 1000 молекул

Ограничения:
  - 12 часов непрерывной работы (потом перезагрузка)
  - T4 GPU слабовата для Diffusion (но можно)
  - Данные не сохраняются между сеансами

Рекомендация: Используй GitHub для сохранения кода/моделей
```

---

### Конфигурация B: ХОРОШИЙ СТАРТ (€2000-3000 одноразово)

```yaml
ИСПОЛЬЗОВАНИЕ: Personal RTX 3070 Desktop
КОГДА: Месяцы 1-12

Specs:
  GPU: NVIDIA RTX 3070 (8 GB VRAM)
  CPU: AMD Ryzen 7 5700X (8 ядер)
  RAM: 32 GB DDR4
  SSD: 1 TB NVMe (+ еще 500 GB для архива)
  OS: Ubuntu 22.04 LTS

Performance:
  QSAR обучение: 5-10 мин (CPU или GPU)
  GNN на 500 молекул: 30-40 мин (GPU)
  GNN на 5000 молекул: 4-5 часов (GPU)
  Diffusion 100 молекул: 30-45 мин (медленно)
  Дозинг 100 молекул: 30-45 мин (CPU параллельно)

Преимущества:
  ✅ Скорость GNN в 10x выше чем CPU
  ✅ Никакой зависимости от интернета (для обучения)
  ✅ Полный контроль над средой
  ✅ Бесплатное использование

Ограничения:
  ❌ 8 GB VRAM - может быть мало для Diffusion
  ❌ Оплата электричества (~500W часов работы)
  ❌ Нужно охлаждение (кондиционер летом)

Рекомендация: Идеально для месяцев 1-12, потом облако для больших моделей
```

---

### Конфигурация C: ПРОФЕССИОНАЛЬНАЯ (€5000+ одноразово)

```yaml
ИСПОЛЬЗОВАНИЕ: RTX 4090 Desktop + AWS облако
КОГДА: Месяцы 7-36 (вся PhD)

LOCAL MACHINE:
  GPU: NVIDIA RTX 4090 (24 GB VRAM)
  CPU: Intel Xeon W7-3495X (60 ядер!)
  RAM: 128 GB DDR5
  SSD: 2x 2TB NVMe RAID 0
  Power: 1500W PSU
  Cost: €8000-10000

CLOUD COMPUTE (по мере необходимости):
  Provider: AWS / Google Cloud
  Instance: g4dn.2xlarge (2x A100) / p4d.24xlarge
  Frequency: 2-3 раза в неделю на 4-8 часов
  Cost: €3000-5000/мес в интенсивные месяцы

Performance LOCAL:
  QSAR: <1 мин
  GNN на 5000 молекул: 20-30 мин
  GNN на 50k молекул: 3-4 часа
  Diffusion 1000 молекул: 2-3 часа
  AlphaFold структура: 5-10 мин (vs 30+ мин на облаке)

Performance CLOUD (A100):
  GNN на 100k молекул: 30-40 мин (параллельный)
  Diffusion 10k молекул: 30-40 мин
  AlphaFold batch 10 комплексов: 5-10 мин

Преимущества:
  ✅ Быстрое development локально
  ✅ Масштабирование в облако когда нужно
  ✅ 24 GB VRAM достаточна для любого проекта
  ✅ GPU ускорение для всех операций

Ограничения:
  ❌ Высокая стоимость (~€120k за PhD)
  ❌ Шум и тепло (нужен офис или хорошая вентиляция)
  ❌ Электричество (+€200/мес)

Рекомендация: Для университета с финансированием или крупного проекта
```

---

## ЧАСТЬ 5: ОБЛАЧНЫЕ ПРОВАЙДЕРЫ - СРАВНЕНИЕ

### Для QSAR + GNN (Месяцы 1-6):

| Провайдер | Instance | GPU | Cost/hour | Total/мес | Notes |
|-----------|----------|-----|-----------|-----------|-------|
| **Google Colab** | T4 | T4 (11GB) | $0 (Pro: $10) | $10 | ✅ BEST для начинающих |
| AWS | g4dn.xlarge | T4 (16GB) | $0.526 | $381 | Хорошо для production |
| Google Cloud | g2-standard-4 | L4 (24GB) | $0.35 | $252 | Дешевле AWS |
| Azure | Standard_NC4as_T4_v3 | T4 (16GB) | $0.35 | $252 | Аналог Google |

**Рекомендация:** Google Colab Pro ($10/мес) для месяцев 1-6

---

### Для Diffusion + AlphaFold (Месяцы 7-12):

| Провайдер | Instance | GPU | Cost/hour | Notes |
|-----------|----------|-----|-----------|-------|
| AWS | p3.2xlarge | V100 (32GB) | $3.06 | Хорошо для DL |
| AWS | g4dn.2xlarge | 2x T4 (32GB total) | $1.052 | Экономно |
| Lambda Labs | 8x A100 | 8x A100 (320GB!) | $8/hour | ✅ BEST для Diffusion |
| Google TPU | v5e Pod | 256 TPUs | $4.30 | Очень быстро, сложновато |

**Рекомендация:** AWS g4dn.2xlarge или Lambda Labs для финальных запусков

---

## ЧАСТЬ 6: СОХРАНЕНИЕ И BACKUP

### Критично для PhD - всё может потеряться!

```
LOCAL MACHINE
    ↓
GitHub (код + notebooks) - бесплатно
    ↓
Google Drive (модели, данные) - 15 GB бесплатно
    ↓
AWS S3 (архивы) - $0.023 per GB/month
    ↓
Внешний USB HDD (1 копия дома)
```

**3-2-1 Backup Rule:**
- 3 копии данных
- 2 разных типа (SSD + HDD)
- 1 в другом месте (облако)

**Стоимость:** €50-100 за хороший USB HDD

---

## ЧАСТЬ 7: РЕКОМЕНДУЕМАЯ СТРАТЕГИЯ

### Мой совет (для реальной PhD):

#### **ШАГ 1: Месяцы 1-3 (€0-50)**
```
✅ Google Colab Pro ($10/мес)
✅ Личный ноутбук (CPU)
✅ GitHub (бесплатно)
✅ Google Drive (бесплатно 15 GB)
```

#### **ШАГ 2: Месяцы 4-12 (€500-1000)**
```
ЕСЛИ ЕСТЬ ДЕНЬГИ:
  ✅ RTX 3070 б/у (€400-600)
  ✅ Colab Pro (€8/мес)
  ✅ AWS г спорадический (€50/мес)

ЕСЛИ НЕТ ДЕНЕГ:
  ✅ Colab Pro (€10/мес)
  ✅ Попросить университет доступ к GPU cluster
```

#### **ШАГ 3: Месяцы 13-36 (€3000-5000)**
```
ЕСЛИ ФИНАНСИРУЕМАЯ PhD:
  ✅ RTX 4090 (€3000)
  ✅ AWS A100 для масштабирования (€200-500/мес)
  ✅ GitHub Pro (€6/мес)

ЕСЛИ САМОФИНАНСИРУЕМАЯ:
  ✅ Colab Pro (€10/мес)
  ✅ Попросить облачные credits у облако-провайдеров
  ✅ Использовать academic discounts
```

---

## ИТОГОВАЯ ТАБЛИЦА

| Параметр | Минимум | Оптимум | Профессионал |
|----------|---------|---------|------------|
| **GPU** | T4 (Colab) | RTX 3070 | RTX 4090 |
| **GPU VRAM** | 11 GB | 8 GB | 24 GB |
| **CPU cores** | 4 | 8 | 16+ |
| **RAM** | 8 GB | 32 GB | 128 GB |
| **SSD** | 256 GB | 512 GB | 2 TB |
| **Стартовая цена** | €0 (Colab) | €2000 | €8000 |
| **Месячная стоимость** | €10 | €100-300 | €500-1000 |
| **QSAR обучение** | 10 мин | 5 мин | <1 мин |
| **GNN на 5k молекул** | 60+ мин | 4-5 часов | 20-30 мин |
| **Diffusion 100 молекул** | Нереально | 30 мин | 5 мин |
| **Рекомендуемый период** | Месяцы 1-6 | Месяцы 1-18 | Весь PhD |

---

**Финальный совет:** Начните с Google Colab Pro, потом смотрите по потребностям. Не нужно сразу покупать RTX 4090 - можно и на T4 GPU обучить GNN!

---

Документ версия: 2.0  
Дата: Декабрь 2025  
Статус: Ready for PhD planning
